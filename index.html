<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Kiara Artha Park - Virtual Tour</title>
	<meta name="description" content="Explore Kiara Artha Park in immersive virtual reality." />
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<meta name="apple-mobile-web-app-status-bar-style" content="black" />
	<meta name="mobile-web-app-capable" content="yes" />
	<meta property="og:title" content="Kiara Artha Park - Virtual Tour" />
	<meta property="og:description" content="Experience the stunning Kiara Artha Park in immersive VR" />
	<meta property="og:image" content="preview.jpg" />

	<link rel="preconnect" href="https://fonts.googleapis.com" />
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
	<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
	<link rel="stylesheet" href="3rdparty/leaflet/leaflet.css" />

	<style>
		/* Modern Reset & Base Styles */
        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        :root {
            --primary: #2A9D8F;
            --primary-dark: #1F756B;
            --secondary: #E9C46A;
            --dark: #264653;
            --light: #F4F1ED;
            --white: #FFFFFF;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }
        
        html {
            height: 100%;
            scroll-behavior: smooth;
        }
        
        body {
            height: 100%;
            margin: 0;
            font-family: 'Poppins', sans-serif;
            background: var(--dark);
            color: var(--white);
            overflow-x: hidden;
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        /* Fix for scroll bars on webkit */
        ::-webkit-scrollbar {
            background-color: rgba(38, 70, 83, 0.8);
            width: 8px;
            height: 8px;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb {
            background-color: var(--primary);
            border-radius: 4px;
        }
        
        /* Layout */
        .app-container {
            display: flex;
            flex-direction: column;
            height: 100%;
            position: hidden;
        }
        
        /* Header */
        header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
			height: 70px; /* Pastikan ini sesuai tinggi sebenarnya */
   			flex-shrink: 0;
            background: rgba(38, 70, 83, 0.95);
            backdrop-filter: blur(8px);
            z-index: 1000;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }
        
        header.scrolled {
            padding: 0.8rem 2rem;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 600;
            font-size: 1.5rem;
            color: var(--white);
            text-decoration: none;
        }
        
        .logo-icon {
            width: 32px;
            height: 32px;
            background-color: var(--primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* Navigation */
        nav ul {
            display: flex;
            list-style: none;
            gap: 1.5rem;
        }
        
        nav a {
            color: var(--light);
            text-decoration: none;
            font-weight: 500;
            padding: 0.5rem;
            transition: var(--transition);
            position: relative;
        }
        
        nav a:hover {
            color: var(--secondary);
        }
        
        nav a::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: 0;
            left: 0;
            background-color: var(--secondary);
            transition: var(--transition);
        }
        
        nav a:hover::after {
            width: 100%;
        }
        
        /* Mobile menu button */
        .menu-toggle {
            display: none;
            background: none;
            border: none;
            color: var(--white);
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        /* Main VR Container */
        .vr-container {
			flex-grow: 1;
			height: calc(100vh - 70px); /* Otomatis pas di bawah header */
			position: relative;
			overflow: hidden;
		}

		#container {
			width: 100%;
			height: 100%;
		}
        
        /* Loading screen */
        .loading-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--dark);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 900;
            transition: opacity 0.5s ease, visibility 0.5s ease;
        }
        
        .loading-overlay.hidden {
            opacity: 0;
            visibility: hidden;
        }
        
        .loader {
            width: 60px;
            height: 60px;
            border: 5px solid rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s ease-in-out infinite;
            margin-bottom: 1rem;
        }
        
        @keyframes spin {
            100% {
                transform: rotate(360deg);
            }
        }
        
        .loading-text {
            font-size: 1.2rem;
            color: var(--light);
            text-align: center;
        }
        
        /* Controls overlay */
        .controls-overlay {
            position: absolute;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 1rem;
            background: rgba(38, 70, 83, 0.7);
            backdrop-filter: blur(8px);
            padding: 0.75rem 1.5rem;
            border-radius: 50px;
            box-shadow: var(--shadow);
            z-index: 800;
        }
        
        .control-btn {
            background: none;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--light);
            background-color: rgba(255, 255, 255, 0.1);
            cursor: pointer;
            transition: var(--transition);
        }
        
        .control-btn:hover {
            background-color: var(--primary);
            transform: scale(1.1);
        }
        
        /* Location info panel */
        .info-panel {
            position: absolute;
            top: 90px;
            right: 2rem;
            width: 300px;
            background: rgba(38, 70, 83, 0.9);
            backdrop-filter: blur(8px);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: var(--shadow);
            z-index: 700;
            transform: translateX(120%);
            transition: transform 0.4s ease;
        }
        
        .info-panel.active {
            transform: translateX(0);
        }
        
        .info-toggle {
            position: absolute;
            top: 90px;
            right: 2rem;
            background: var(--primary);
            color: var(--white);
            width: 40px;
            height: 40px;
            border: none;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 750;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }
        
        .info-toggle:hover {
            background: var(--primary-dark);
        }
        
        .location-title {
            margin-bottom: 1rem;
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--secondary);
        }
        
        .location-description {
            margin-bottom: 1rem;
            font-size: 0.9rem;
            line-height: 1.5;
        }
        
        .hotspot-list {
            list-style: none;
        }
        
        .hotspot-item {
            display: flex;
            align-items: center;
            margin-bottom: 0.75rem;
            padding: 0.5rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .hotspot-item:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .hotspot-icon {
            margin-right: 0.75rem;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--primary);
            border-radius: 50%;
            flex-shrink: 0;
        }
        
        /* Mobile responsiveness */
        @media (max-width: 768px) {
            header {
                padding: 0.8rem 1rem;
            }
            
            .logo {
                font-size: 1.2rem;
            }
            
            nav {
                position: fixed;
                top: 70px;
                left: 0;
                right: 0;
                background: rgba(38, 70, 83, 0.95);
                backdrop-filter: blur(8px);
                clip-path: circle(0% at top right);
                transition: clip-path 0.4s ease;
                z-index: 990;
            }
            
            nav.active {
                clip-path: circle(150% at top right);
            }
            
            nav ul {
                flex-direction: column;
                padding: 2rem 1rem;
                gap: 1rem;
            }
            
            .menu-toggle {
                display: block;
            }
            
            .info-panel {
                width: 90%;
                left: 50%;
                right: auto;
                transform: translate(-50%, 100%);
                bottom: 0;
                top: auto;
                border-bottom-left-radius: 0;
                border-bottom-right-radius: 0;
            }
            
            .info-panel.active {
                transform: translate(-50%, 0);
            }
            
            .info-toggle {
                top: auto;
                bottom: 5rem;
                right: 1rem;
            }
            
            .controls-overlay {
                bottom: 1rem;
                padding: 0.5rem 1rem;
            }
            
            .control-btn {
                width: 36px;
                height: 36px;
            }
        }
	</style>
</head>
<body>
	<div class="app-container">
		<header id="header">
			<a href="#" class="logo">
				<div class="logo-icon">KA</div>
				<span>Kiara Artha Park</span>
			</a>
			<nav id="nav"></nav>
			<button class="menu-toggle" id="menuToggle">☰</button>
		</header>

		<div class="loading-overlay" id="loadingOverlay">
			<div class="loader"></div>
			<div class="loading-text">
				<p>Loading Kiara Artha Park VR Experience</p>
				<p>Please wait...</p>
			</div>
		</div>

		<div class="vr-container">
			<div id="container"></div>

			<div class="controls-overlay">
				<button class="control-btn" id="zoomIn">+</button>
				<button class="control-btn" id="zoomOut">-</button>
				<button class="control-btn" id="fullscreen">⛶</button>
				<button class="control-btn" id="autoRotate">⟳</button>
			</div>

			<button class="info-toggle" id="infoToggle">i</button>
			<div class="info-panel" id="infoPanel">
				<h3 class="location-title">Description</h3>
				<p class="location-description">
					Kiara Artha Park is a vibrant destination offering Instagrammable spots...
				</p>
			</div>
		</div>
	</div>

	<!-- Scripts -->
	<script src="pano2vr_player.js?ts=1761496"></script>
	<script src="skin.js?ts=1761496"></script>
	<script src="https://www.youtube.com/iframe_api"></script>
	<script src="https://player.vimeo.com/api/player.js"></script>
	<script src="3rdparty/leaflet/leaflet.js"></script>
	<!-- Initialization Script -->
    <script>
        // Pano2VR parameter parsing
        function parseParams(paramsString, params) {
            paramsString = paramsString.substring(1);
            let firstSeparatorPos = paramsString.indexOf(",");
            if (firstSeparatorPos !== -1) {
                params.startNode = paramsString.slice(0, firstSeparatorPos);
                let viewingParams = paramsString.slice(firstSeparatorPos + 1).split(",");
                if (viewingParams.length >= 3) {
                    params.startView = {
                        pan: viewingParams[0],
                        tilt: viewingParams[1],
                        fov: viewingParams[2],
                        projection: viewingParams[3] || undefined
                    };
                }
            } else {
                params.startNode = paramsString;
                params.startView = "";
            }
        }

        let params = {};
        parseParams(document.location.hash, params);
        let startNode = params.startNode;
        let startView = params.startView;

        if ("onhashchange" in window && !(/MSIE (\d+\.\d+);/.test(navigator.userAgent))) {
            window.onhashchange = () => {
                parseParams(window.location.hash, params);
                pano.openNext('{' + params.startNode + '}', params.startView);
            };
        } else {
            let lastHash = window.location.hash;
            setInterval(() => {
                if (window.location.hash !== lastHash) {
                    lastHash = window.location.hash;
                    parseParams(window.location.hash, params);
                    pano.openNext('{' + params.startNode + '}', params.startView);
                }
            }, 100);
        }

        document.addEventListener("DOMContentLoaded", () => {
            const header = document.getElementById("header");
            const menuToggle = document.getElementById("menuToggle");
            const nav = document.getElementById("nav");
            const loadingOverlay = document.getElementById("loadingOverlay");
            const infoToggle = document.getElementById("infoToggle");
            const infoPanel = document.getElementById("infoPanel");
            const hotspotItems = document.querySelectorAll(".hotspot-item");

            window.pano = new pano2vrPlayer("container");
            pano.startNode = startNode;
            pano.startView = startView;
            pano.setQueryParameter("ts=1761496");
            window.skin = new pano2vrSkin(pano);
            pano.readConfigUrlAsync("pano.xml?ts=1761496");

            pano.addListener("configloaded", () => {
                setTimeout(() => loadingOverlay.classList.add("hidden"), 1000);
            });

            menuToggle.addEventListener("click", () => {
                nav.classList.toggle("active");
                menuToggle.textContent = nav.classList.contains("active") ? "✕" : "☰";
            });

            infoToggle.addEventListener("click", () => {
                infoPanel.classList.toggle("active");
            });

            window.addEventListener("scroll", () => {
                header.classList.toggle("scrolled", window.scrollY > 10);
            });

            document.getElementById("zoomIn").addEventListener("click", () => pano.changeFovLog(-0.2));
            document.getElementById("zoomOut").addEventListener("click", () => pano.changeFovLog(0.2));
            document.getElementById("fullscreen").addEventListener("click", () => pano.toggleFullscreen());
           
            let isRotating = false;
            document.getElementById("autoRotate").addEventListener("click", () => {
                isRotating = !isRotating;
                if (isRotating) {
                    pano.startAutorotate(1.0, 0, 1.0);
                    autoRotate.style.backgroundColor = "var(--primary)";
                } else {
                    pano.stopAutorotate();
                    autoRotate.style.backgroundColor = "rgba(255, 255, 255, 0.1)";
                }
            });

            hotspotItems.forEach(item => {
                item.addEventListener("click", () => {
                    const nodeId = item.dataset.node;
                    pano.openNext('{' + nodeId + '}');
                    document.querySelector(".location-title").textContent = "Current Location: " + item.querySelector("span").textContent;
                });
            });

            if (/Safari/i.test(window.navigator.userAgent)) {
                function iosHfix() {
                    window.scrollTo(0, 1);
                    let container = document.getElementById("container");
                    let oh = container.offsetHeight;
                    document.documentElement.style.setProperty("height", "100vh");
                    container.style.setProperty("height", oh !== container.offsetHeight ? "100%" : window.innerHeight + "px");
                    window.scrollTo(0, 0);
                    pano.setViewerSize(container.offsetWidth, container.offsetHeight);
                }

                setTimeout(iosHfix, 0);
                setTimeout(iosHfix, 100);
                window.addEventListener("resize", () => {
                    [0, 500, 1000, 2000].forEach(t => setTimeout(iosHfix, t));
                });
            }
        });
    </script>

	<script>
		function adjustVRHeight() {
			const header = document.querySelector('header');
			const vrContainer = document.querySelector('.vr-container');
			const headerHeight = header.offsetHeight;
			vrContainer.style.height = calc(100vh - ${headerHeight}px);
		}

		window.addEventListener('resize', adjustVRHeight);
		window.addEventListener('load', adjustVRHeight);
	</script>

</body>
</html>